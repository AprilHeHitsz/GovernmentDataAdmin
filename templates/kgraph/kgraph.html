{% extends "base.html" %}
{% load static %}
{% block content %}
        <!-- Page Content -->
        <!-- ============================================================== -->
        <div id="page-wrapper">
            <div class="container-fluid">
                <div class="row bg-title">
                    <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
                        <h4 class="page-title">Kgraph</h4>
                    </div>
                    <div class="col-lg-9 col-sm-8 col-md-8 col-xs-12">
                        <ol class="breadcrumb">
                            <li class="active">Kgraph</li>
                        </ol>
                    </div>
                    <!-- /.col-lg-12 -->
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="white-box">
                            <div style="width: 200px; align-self: center">
                                <form role="search" method="GET" class="app-search hidden-sm hidden-xs m-r-10">
                                    {% if kg_search %}
                                        <input type="text" name="kgsearch" id="kgsearch_id" class="form-control" value="{{ kg_search }}" required>
                                    {% else %}
                                        <input type="text" name="kgsearch" id="kgsearch_id" placeholder="Search..." class="form-control" required>
                                    {% endif %}
                                    <a>
                                        <i class="fa fa-search" onclick="kgsearch()"></i>
                                        <script type="text/javascript" language="JavaScript">
                                            function kgsearch() {
                                                let searchBar = document.getElementById("kgsearch_id");
                                                let toUrl = "http://" + self.location.host + "/kgraph?search=" + searchBar.value;
                                                self.location.href = toUrl;
                                            }
                                        </script>
                                    </a>
                                </form>
                            </div>
                            <div id="graph" class="chart-container" style="height: 800px;"></div>
                            <script type="text/javascript"  language="JavaScript">
                                let graph_chart = echarts.init(
                                    document.getElementById('graph'), 'white', {renderer: 'svg'}
                                );
                                graph_chart.setOption({{ graph | safe}});
                                graph_chart.on('click',function(params){
                                    let toUrl="http://"+self.location.host+"/kgraph?search="+params.name;
                                    self.location.href=toUrl;
                                });
                            </script>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.container-fluid -->
            {% include 'footer.html' %}
        </div>
        <!-- ============================================================== -->
        <!-- End Page Content -->
{% endblock content %}

{% block script %}

{% endblock script %}